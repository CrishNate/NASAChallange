import numpy as np
from scipy import signal
from astropy.convolution import convolve
from scipy.signal import convolve as scipy_convolve

import matplotlib.pyplot as plt

FILTER_TAP_NUM = 37

filter_taps = np.array([
  0.0300165397247597,
  -0.015538368756991341,
  -0.07095616396580683,
  0.044540785968257154,
  0.05841099064452284,
  0.05223011038149585,
  -0.11537135632771017,
  -0.28769273191623557,
  0.6158040135249913,
  -0.28769273191623557,
  -0.11537135632771017,
  0.05223011038149585,
  0.05841099064452284,
  0.044540785968257154,
  -0.07095616396580683,
  -0.015538368756991341,
  0.0300165397247597
])

filter_taps_h = np.array([
  -0.004501277156423485,
  -0.016379331279339892,
  -0.02248496418410882,
  -0.03342316986468254,
  -0.038965018795636346,
  -0.03854678888383957,
  -0.0280181688150478,
  -0.006472522971809094,
  0.025414696010118646,
  0.06420618685133575,
  0.10448352161192129,
  0.13974650181058693,
  0.1638594112978867,
  0.17242216115815265,
  0.1638594112978867,
  0.13974650181058693,
  0.10448352161192129,
  0.06420618685133575,
  0.025414696010118646,
  -0.006472522971809094,
  -0.0280181688150478,
  -0.03854678888383957,
  -0.038965018795636346,
  -0.03342316986468254,
  -0.02248496418410882,
  -0.016379331279339892,
  -0.004501277156423485
])

def filter(signal):
  low_pass = scipy_convolve(signal, filter_taps, mode='same', method='direct')
  hight_pass = scipy_convolve(signal, filter_taps_h, mode='same', method='direct')

  return np.maximum(low_pass - hight_pass, 0)