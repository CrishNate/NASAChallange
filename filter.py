import numpy as np
from scipy import signal
from astropy.convolution import convolve
from scipy.signal import convolve as scipy_convolve

import matplotlib.pyplot as plt

FILTER_TAP_NUM = 37

filter_taps_h = np.array([
  0.0300165397247597,
  -0.015538368756991341,
  -0.07095616396580683,
  0.044540785968257154,
  0.05841099064452284,
  0.05223011038149585,
  -0.11537135632771017,
  -0.28769273191623557,
  0.6158040135249913,
  -0.28769273191623557,
  -0.11537135632771017,
  0.05223011038149585,
  0.05841099064452284,
  0.044540785968257154,
  -0.07095616396580683,
  -0.015538368756991341,
  0.0300165397247597
])

filter_taps = np.array([
  -0.012035194013569433,
  0.006414143164815957,
  0.06247974902645986,
  0.0791063287057521,
  -0.012201266242778348,
  -0.09842856123541179,
  0.02157724459255415,
  0.3162978058121597,
  0.47845222683695554,
  0.3162978058121597,
  0.02157724459255415,
  -0.09842856123541179,
  -0.012201266242778348,
  0.0791063287057521,
  0.06247974902645986,
  0.006414143164815957,
  -0.012035194013569433
])

def filter(signal):
  low_pass = scipy_convolve(signal, filter_taps, mode='same', method='direct')
  hight_pass = scipy_convolve(signal, filter_taps_h, mode='same', method='direct')

  return np.maximum(hight_pass - low_pass, 0)